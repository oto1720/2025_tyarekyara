# Settings Feature (è¨­å®šæ©Ÿèƒ½)

## ğŸ“‹ ç›®æ¬¡
- [æ¦‚è¦](#æ¦‚è¦)
- [ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£](#ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£)
- [ä¾å­˜é–¢ä¿‚](#ä¾å­˜é–¢ä¿‚)
- [ã‚¯ãƒ©ã‚¹å›³ã¨é–¢ä¿‚æ€§](#ã‚¯ãƒ©ã‚¹å›³ã¨é–¢ä¿‚æ€§)
- [ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼](#ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼)
- [ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ ](#ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ )
- [å„ãƒ•ã‚¡ã‚¤ãƒ«ã®è©³ç´°èª¬æ˜](#å„ãƒ•ã‚¡ã‚¤ãƒ«ã®è©³ç´°èª¬æ˜)
- [ç”»é¢ä¸€è¦§](#ç”»é¢ä¸€è¦§)
- [ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºæ–¹æ³•](#ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºæ–¹æ³•)
- [æ–°ã—ã„è¨­å®šé …ç›®ã®è¿½åŠ æ–¹æ³•](#æ–°ã—ã„è¨­å®šé …ç›®ã®è¿½åŠ æ–¹æ³•)
- [ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°](#ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°)

---

## æ¦‚è¦

ã“ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã¯ã€ã‚¢ãƒ—ãƒªã®è¨­å®šæ©Ÿèƒ½å…¨ä½“ã‚’ç®¡ç†ã—ã¦ã„ã¾ã™ã€‚ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ã®ç·¨é›†ã€é€šçŸ¥è¨­å®šã€ãã®ä»–ã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³è¨­å®šã‚’å«ã¿ã¾ã™ã€‚

### ä¸»ãªæ©Ÿèƒ½
- âœ… ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ç·¨é›†ï¼ˆãƒ‹ãƒƒã‚¯ãƒãƒ¼ãƒ ã€ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã€ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã€å¹´ä»£ã€åœ°åŸŸã€ã‚¢ã‚¤ã‚³ãƒ³ï¼‰
- âœ… é€šçŸ¥è¨­å®šï¼ˆON/OFFã€æ™‚åˆ»é¸æŠã€ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºï¼‰
- âœ… FCMï¼ˆFirebase Cloud Messagingï¼‰ã«ã‚ˆã‚‹é€šçŸ¥ç®¡ç†
- âœ… ãƒãƒƒãƒãƒ³ã‚°é€šçŸ¥ã®è¡¨ç¤º
- âœ… ãã®ä»–ã®è¨­å®šé …ç›®ã®æ‹¡å¼µå¯èƒ½ãªæ§‹é€ 

---

## ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

ã“ã®ãƒ•ã‚£ãƒ¼ãƒãƒ£ãƒ¼ã¯ã€ä»¥ä¸‹ã®ãƒ¬ã‚¤ãƒ¤ãƒ¼ã«åˆ†ã‹ã‚Œã¦ã„ã¾ã™ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Presentationå±¤                         â”‚
â”‚  (pages/, widgets/)                                      â”‚
â”‚  - UIè¡¨ç¤ºã¨ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ã‚·ãƒ§ãƒ³                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Providerså±¤                            â”‚
â”‚  (providers/)                                            â”‚
â”‚  - çŠ¶æ…‹ç®¡ç†ã¨ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯                              â”‚
â”‚  - Riverpod Notifierã‚’ä½¿ç”¨                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                Serviceså±¤ / Repositorieså±¤               â”‚
â”‚  (services/)                                             â”‚
â”‚  - å¤–éƒ¨APIã¨ã®é€šä¿¡                                        â”‚
â”‚  - Firebase / ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã¨ã®é€£æº                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Modelså±¤                               â”‚
â”‚  (models/)                                               â”‚
â”‚  - ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«ã®å®šç¾©                                      â”‚
â”‚  - Freezedã«ã‚ˆã‚‹ã‚¤ãƒŸãƒ¥ãƒ¼ã‚¿ãƒ–ãƒ«ã‚¯ãƒ©ã‚¹                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ä¾å­˜é–¢ä¿‚

### å¤–éƒ¨ä¾å­˜ï¼ˆä»–ãƒ•ã‚£ãƒ¼ãƒãƒ£ãƒ¼ï¼‰

```
settings/
  â”œâ”€â”€ â†’ auth/
  â”‚     â”œâ”€â”€ authServiceProvider (èªè¨¼ã‚µãƒ¼ãƒ“ã‚¹)
  â”‚     â”œâ”€â”€ currentUserProvider (ç¾åœ¨ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±)
  â”‚     â””â”€â”€ storageServiceProvider (ç”»åƒã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰)
  â”‚
  â””â”€â”€ â†’ core/
        â””â”€â”€ router (ç”»é¢é·ç§»)
```

### å†…éƒ¨ä¾å­˜ï¼ˆsettingså†…ï¼‰

```
presentation/
  â”œâ”€â”€ settings_screen.dart
  â”‚     â””â”€â”€ â†’ auth/currentUserProvider
  â”‚
  â”œâ”€â”€ profile_screen.dart
  â”‚     â”œâ”€â”€ â†’ providers/profile_edit_provider
  â”‚     â”œâ”€â”€ â†’ providers/profile_update_provider
  â”‚     â””â”€â”€ â†’ auth/currentUserProvider
  â”‚
  â””â”€â”€ notice_screen.dart
        â””â”€â”€ â†’ providers/notification_provider

providers/
  â”œâ”€â”€ profile_edit_provider.dart
  â”‚     â””â”€â”€ â†’ models/profile_edit_state
  â”‚
  â”œâ”€â”€ profile_update_provider.dart
  â”‚     â”œâ”€â”€ â†’ auth/authServiceProvider
  â”‚     â”œâ”€â”€ â†’ auth/storageServiceProvider
  â”‚     â””â”€â”€ â†’ auth/currentUserProvider
  â”‚
  â””â”€â”€ notification_provider.dart
        â”œâ”€â”€ â†’ services/notification_service
        â”œâ”€â”€ â†’ models/notification_settings
        â””â”€â”€ â†’ shared_preferences (æ°¸ç¶šåŒ–)

services/
  â””â”€â”€ notification_service.dart
        â”œâ”€â”€ â†’ flutter_local_notifications
        â”œâ”€â”€ â†’ firebase_messaging
        â”œâ”€â”€ â†’ cloud_firestore
        â””â”€â”€ â†’ models/notification_settings
```

### ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ä¾å­˜

```yaml
dependencies:
  # çŠ¶æ…‹ç®¡ç†
  flutter_riverpod: ^3.0.0

  # ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«
  freezed_annotation: ^2.4.1
  json_annotation: ^4.8.1

  # ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸
  shared_preferences: ^2.2.2

  # ç”»åƒé¸æŠ
  image_picker: æœ€æ–°ç‰ˆ

  # é€šçŸ¥
  flutter_local_notifications: ^18.0.1
  timezone: ^0.9.2

  # Firebase
  firebase_auth: æœ€æ–°ç‰ˆ
  firebase_messaging: æœ€æ–°ç‰ˆ
  cloud_firestore: æœ€æ–°ç‰ˆ
  firebase_storage: æœ€æ–°ç‰ˆ

dev_dependencies:
  # ã‚³ãƒ¼ãƒ‰ç”Ÿæˆ
  build_runner: ^2.4.6
  freezed: ^2.4.5
  json_serializable: ^6.7.1
```

---

## ã‚¯ãƒ©ã‚¹å›³ã¨é–¢ä¿‚æ€§

### ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ç·¨é›†æ©Ÿèƒ½ã®é–¢ä¿‚å›³

```
ProfileScreen (ç”»é¢)
    â”‚
    â”œâ”€ èª­ã¿å–ã‚Š â†’ currentUserProvider (ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±)
    â”‚                 â†“
    â”‚              authServiceProvider
    â”‚
    â”œâ”€ çŠ¶æ…‹ç®¡ç† â†’ ProfileEditNotifier
    â”‚                 â†“
    â”‚              ProfileEditState (çŠ¶æ…‹ã‚¯ãƒ©ã‚¹)
    â”‚                 - nickname: String
    â”‚                 - ageRange: String?
    â”‚                 - region: String?
    â”‚                 - selectedImage: File?
    â”‚                 - isEditingPassword: bool
    â”‚                 - currentPassword: String
    â”‚                 - newPassword: String
    â”‚                 - confirmPassword: String
    â”‚                 - validation: ProfileEditValidation
    â”‚
    â””â”€ æ›´æ–°å‡¦ç† â†’ ProfileUpdateNotifier
                      â†“
                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                   â–¼              â–¼                 â–¼
            authServiceProvider  storageServiceProvider  currentUserProvider
                   â†“              â†“                 â†“
              (Firestoreæ›´æ–°)  (ç”»åƒã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰)  (çŠ¶æ…‹ãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥)
```

**ã‚¯ãƒ©ã‚¹ã®å½¹å‰²**:
- `ProfileScreen`: UIã¨ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ã‚·ãƒ§ãƒ³
- `ProfileEditNotifier`: ãƒ•ã‚©ãƒ¼ãƒ ã®çŠ¶æ…‹ç®¡ç†ã¨ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³
- `ProfileUpdateNotifier`: ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«æ›´æ–°ã®ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯
- `authServiceProvider`: Firebase Authenticationã¨ã®é€£æº
- `storageServiceProvider`: Firebase Storageã¸ã®ç”»åƒã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰

### é€šçŸ¥è¨­å®šæ©Ÿèƒ½ã®é–¢ä¿‚å›³

```
NoticeScreen (ç”»é¢)
    â”‚
    â””â”€ çŠ¶æ…‹ç®¡ç†ãƒ»æ“ä½œ â†’ NotificationSettingsNotifier
                            â†“
                         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                         â–¼                â–¼                 â–¼
                  NotificationService  SharedPreferences  NotificationSettings
                         â†“                â†“                 (ãƒ¢ãƒ‡ãƒ«)
                   â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
                   â–¼          â–¼          â–¼
      FlutterLocalNotifications  FirebaseMessaging  Firestore
           (ãƒ­ãƒ¼ã‚«ãƒ«é€šçŸ¥)       (FCM)         (ãƒˆãƒ¼ã‚¯ãƒ³ä¿å­˜)
```

**ã‚¯ãƒ©ã‚¹ã®å½¹å‰²**:
- `NoticeScreen`: UIã¨ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ã‚·ãƒ§ãƒ³
- `NotificationSettingsNotifier`: é€šçŸ¥è¨­å®šã®çŠ¶æ…‹ç®¡ç†
- `NotificationService`: é€šçŸ¥æ©Ÿèƒ½ã®å®Ÿè£…ï¼ˆã‚·ãƒ³ã‚°ãƒ«ãƒˆãƒ³ï¼‰
- `NotificationSettings`: é€šçŸ¥è¨­å®šã®ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«
- `SharedPreferences`: é€šçŸ¥è¨­å®šã®æ°¸ç¶šåŒ–

### è¨­å®šç”»é¢ã®æ§‹é€ 

```
SettingsScreen (ãƒ¡ã‚¤ãƒ³ç”»é¢)
    â”‚
    â”œâ”€ Widget â†’ SettingSection (ã‚»ã‚¯ã‚·ãƒ§ãƒ³ãƒ˜ãƒƒãƒ€ãƒ¼)
    â”œâ”€ Widget â†’ SettingItem (é€šå¸¸ã®è¨­å®šé …ç›®)
    â””â”€ Widget â†’ DangerSettingItem (å±é™ºãªæ“ä½œç”¨)
    â”‚
    â””â”€ ç”»é¢é·ç§» â”¬â†’ ProfileScreen (/profile)
                â”œâ†’ NoticeScreen (/notice)
                â””â†’ ãã®ä»–ã®è¨­å®šç”»é¢
```

---

## ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼

### ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«æ›´æ–°ã®ãƒ•ãƒ­ãƒ¼

```
1. ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒProfileScreenã§ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ã‚’ç·¨é›†
   â†“
2. ProfileEditNotifierã§çŠ¶æ…‹ã‚’ç®¡ç†
   - ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè¡Œ
   - ãƒ•ã‚©ãƒ¼ãƒ ã®çŠ¶æ…‹ã‚’ä¿æŒ
   â†“
3. ä¿å­˜ãƒœã‚¿ãƒ³ã‚¿ãƒƒãƒ—
   â†“
4. ProfileUpdateNotifierã®å„ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å‘¼ã³å‡ºã—
   - updateProfile(): åŸºæœ¬æƒ…å ±æ›´æ–°
   - updateProfileImage(): ç”»åƒã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
   - updateEmail(): ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹æ›´æ–°ï¼ˆå†èªè¨¼å¿…è¦ï¼‰
   - updatePassword(): ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰æ›´æ–°ï¼ˆå†èªè¨¼å¿…è¦ï¼‰
   â†“
5. authServiceProviderã‚’é€šã˜ã¦Firebaseã«ä¿å­˜
   - Firestore: ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±
   - Storage: ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ç”»åƒ
   - Auth: ãƒ¡ãƒ¼ãƒ«/ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰
   â†“
6. currentUserProviderã‚’ç„¡åŠ¹åŒ–ã—ã¦UIã‚’æ›´æ–°
   â†“
7. æˆåŠŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¡¨ç¤ºã¨ç”»é¢ã‚’æˆ»ã‚‹
```

### é€šçŸ¥è¨­å®šã®ãƒ•ãƒ­ãƒ¼

```
1. ã‚¢ãƒ—ãƒªèµ·å‹•æ™‚
   â†“
2. NotificationServiceåˆæœŸåŒ–
   - flutter_local_notificationsã®åˆæœŸåŒ–
   - FCMã®åˆæœŸåŒ–ã¨æ¨©é™ãƒªã‚¯ã‚¨ã‚¹ãƒˆ
   - FCMãƒˆãƒ¼ã‚¯ãƒ³ã®å–å¾—
   â†“
3. NotificationSettingsNotifieråˆæœŸåŒ–
   - SharedPreferencesã‹ã‚‰è¨­å®šèª­ã¿è¾¼ã¿
   - NotificationServiceã«è¨­å®šã‚’åæ˜ 
   â†“
4. ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒNoticeScreenã§è¨­å®šå¤‰æ›´
   â†“
5. NotificationSettingsNotifierã§çŠ¶æ…‹æ›´æ–°
   - toggleNotification(): ON/OFFåˆ‡ã‚Šæ›¿ãˆ
   - updateTime(): é€šçŸ¥æ™‚åˆ»å¤‰æ›´
   - updateMessage(): ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å¤‰æ›´
   â†“
6. SharedPreferencesã«ä¿å­˜
   â†“
7. NotificationServiceã§é€šçŸ¥ã‚’ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«
   - scheduleDailyNotification(): æ¯æ—¥ã®é€šçŸ¥è¨­å®š
   - æ—¢å­˜ã®é€šçŸ¥ã‚’ã‚­ãƒ£ãƒ³ã‚»ãƒ«ã—ã¦æ–°è¦ä½œæˆ
   â†“
8. é€šçŸ¥ãŒæŒ‡å®šæ™‚åˆ»ã«é…ä¿¡ã•ã‚Œã‚‹
```

### ãƒãƒƒãƒãƒ³ã‚°é€šçŸ¥ã®ãƒ•ãƒ­ãƒ¼ï¼ˆFCMï¼‰

```
1. ã‚µãƒ¼ãƒãƒ¼ã‹ã‚‰FCMãƒ¡ãƒƒã‚»ãƒ¼ã‚¸é€ä¿¡
   - å®›å…ˆ: ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®FCMãƒˆãƒ¼ã‚¯ãƒ³
   - ãƒšã‚¤ãƒ­ãƒ¼ãƒ‰: { matchId: "xxx" }
   â†“
2. NotificationServiceã§å—ä¿¡
   - ãƒ•ã‚©ã‚¢ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰: _handleForegroundMessage()
   - ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰: firebaseMessagingBackgroundHandler()
   - é€šçŸ¥ã‚¿ãƒƒãƒ—: _handleMessageOpenedApp()
   â†“
3. ãƒ­ãƒ¼ã‚«ãƒ«é€šçŸ¥ã‚’è¡¨ç¤º
   - showMatchNotification()
   â†“
4. ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒé€šçŸ¥ã‚’ã‚¿ãƒƒãƒ—
   â†“
5. onMatchNotificationTapped ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯å®Ÿè¡Œ
   - matchIdã‚’ä½¿ã£ã¦é©åˆ‡ãªç”»é¢ã«é·ç§»
```

---

## ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ 

```
lib/feature/settings/
â”œâ”€â”€ README.md                          # ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«
â”œâ”€â”€ REFACTORING.md                     # ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°å±¥æ­´
â”‚
â”œâ”€â”€ models/                            # ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«
â”‚   â”œâ”€â”€ notification_settings.dart     # é€šçŸ¥è¨­å®šãƒ¢ãƒ‡ãƒ«
â”‚   â”œâ”€â”€ notification_settings.freezed.dart  # è‡ªå‹•ç”Ÿæˆï¼ˆç·¨é›†ä¸è¦ï¼‰
â”‚   â””â”€â”€ notification_settings.g.dart   # è‡ªå‹•ç”Ÿæˆï¼ˆç·¨é›†ä¸è¦ï¼‰
â”‚
â”œâ”€â”€ presentation/                      # UIå±¤
â”‚   â”œâ”€â”€ pages/                         # ç”»é¢
â”‚   â”‚   â”œâ”€â”€ settings_screen.dart       # ãƒ¡ã‚¤ãƒ³è¨­å®šç”»é¢
â”‚   â”‚   â”œâ”€â”€ profile_screen.dart        # ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ç·¨é›†ç”»é¢
â”‚   â”‚   â””â”€â”€ notice_screen.dart         # é€šçŸ¥è¨­å®šç”»é¢
â”‚   â”‚
â”‚   â””â”€â”€ widgets/                       # ã‚¦ã‚£ã‚¸ã‚§ãƒƒãƒˆ
â”‚       â”œâ”€â”€ setting_item.dart          # è¨­å®šé …ç›®ç”¨ã‚¦ã‚£ã‚¸ã‚§ãƒƒãƒˆ
â”‚       â”œâ”€â”€ profile_widgets.dart       # ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ç”»é¢ç”¨ã‚¦ã‚£ã‚¸ã‚§ãƒƒãƒˆ
â”‚       â””â”€â”€ notice_widgets.dart        # é€šçŸ¥ç”»é¢ç”¨ã‚¦ã‚£ã‚¸ã‚§ãƒƒãƒˆ
â”‚
â”œâ”€â”€ providers/                         # çŠ¶æ…‹ç®¡ç†
â”‚   â”œâ”€â”€ profile_edit_provider.dart     # ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ç·¨é›†ã®çŠ¶æ…‹ç®¡ç†
â”‚   â”œâ”€â”€ profile_edit_state.dart        # ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ç·¨é›†ã®çŠ¶æ…‹å®šç¾©
â”‚   â”œâ”€â”€ profile_edit_state.freezed.dart # è‡ªå‹•ç”Ÿæˆï¼ˆç·¨é›†ä¸è¦ï¼‰
â”‚   â”œâ”€â”€ profile_update_provider.dart   # ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«æ›´æ–°ãƒ­ã‚¸ãƒƒã‚¯
â”‚   â””â”€â”€ notification_provider.dart     # é€šçŸ¥è¨­å®šãƒ­ã‚¸ãƒƒã‚¯
â”‚
â”œâ”€â”€ repositories/                      # ãƒªãƒã‚¸ãƒˆãƒªï¼ˆç¾åœ¨ã¯ç©ºï¼‰
â”‚
â””â”€â”€ services/                          # ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯
    â””â”€â”€ notification_service.dart      # é€šçŸ¥ã‚µãƒ¼ãƒ“ã‚¹
```

---

## å„ãƒ•ã‚¡ã‚¤ãƒ«ã®è©³ç´°èª¬æ˜

### ğŸ“± Presentationå±¤ï¼ˆUIï¼‰

#### `presentation/pages/settings_screen.dart`
**å½¹å‰²**: è¨­å®šã®ãƒ¡ã‚¤ãƒ³ç”»é¢

**ä¸»ãªã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ**:
- `SettingSection`: ã‚»ã‚¯ã‚·ãƒ§ãƒ³ãƒ˜ãƒƒãƒ€ãƒ¼ï¼ˆã‚«ãƒ†ã‚´ãƒªåã‚’è¡¨ç¤ºï¼‰
- `SettingItem`: é€šå¸¸ã®è¨­å®šé …ç›®
- `DangerSettingItem`: å±é™ºãªæ“ä½œç”¨ï¼ˆãƒ­ã‚°ã‚¢ã‚¦ãƒˆãªã©ï¼‰

**ä½¿ç”¨ã—ã¦ã„ã‚‹ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼**:
```dart
// lib/feature/settings/presentation/pages/settings_screen.dart:XX
ref.watch(currentUserProvider)  // ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ã®å–å¾—
ref.read(authServiceProvider)   // ãƒ­ã‚°ã‚¢ã‚¦ãƒˆå‡¦ç†
```

**ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºãƒã‚¤ãƒ³ãƒˆ**:
```dart
// æ–°ã—ã„è¨­å®šé …ç›®ã‚’è¿½åŠ ã™ã‚‹å ´åˆ
SettingItem(
  icon: Icons.your_icon,          // ã‚¢ã‚¤ã‚³ãƒ³
  title: 'è¨­å®šé …ç›®å',
  subtitle: 'èª¬æ˜æ–‡',
  iconColor: Colors.blue,          // ã‚¢ã‚¤ã‚³ãƒ³ã®è‰²
  onTap: () {
    context.push('/your-route');   // é·ç§»å…ˆ
  },
),
```

---

#### `presentation/pages/profile_screen.dart`
**å½¹å‰²**: ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ç·¨é›†ç”»é¢

**ä½¿ç”¨ã—ã¦ã„ã‚‹ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼**:
```dart
// lib/feature/settings/presentation/pages/profile_screen.dart:XX
ref.watch(currentUserProvider)           // ç¾åœ¨ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±
ref.watch(profileEditProvider)           // ç·¨é›†ä¸­ã®çŠ¶æ…‹
ref.read(profileSaveProvider.notifier)   // ä¿å­˜å‡¦ç†
```

**ä¸»ãªæ©Ÿèƒ½**:
1. **ç”»åƒé¸æŠ**: `_pickImage(ImageSource source)`
   - ã‚®ãƒ£ãƒ©ãƒªãƒ¼ã¾ãŸã¯ã‚«ãƒ¡ãƒ©ã‹ã‚‰ç”»åƒã‚’é¸æŠ
   - é¸æŠã—ãŸç”»åƒã‚’ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼è¡¨ç¤º

2. **ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ä¿å­˜**: `_saveProfile()`
   - ProfileSaveNotifierã‚’å‘¼ã³å‡ºã—
   - ç”»åƒã‚’Firebase Storageã«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
   - ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ã‚’Firestoreã«ä¿å­˜
   - ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹å¤‰æ›´æ™‚ã¯å†èªè¨¼
   - ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰å¤‰æ›´æ™‚ã‚‚å†èªè¨¼

**çŠ¶æ…‹ãƒ•ãƒ­ãƒ¼**:
```
ProfileEditState (ç·¨é›†ä¸­ã®çŠ¶æ…‹)
  â†“
ProfileSaveNotifier.save() (ä¿å­˜å‡¦ç†)
  â†“
ProfileUpdateNotifier (å„ç¨®æ›´æ–°ãƒ¡ã‚½ãƒƒãƒ‰)
  â†“
authServiceProvider / storageServiceProvider
```

**ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºãƒã‚¤ãƒ³ãƒˆ**:
```dart
// lib/feature/settings/presentation/pages/profile_screen.dart:XX
// å¹´ä»£ãƒ»åœ°åŸŸã®é¸æŠè‚¢ã‚’å¤‰æ›´
final List<String> _ageRanges = [
  '10æ­³æœªæº€',
  '10ä»£',
  // ... è¿½åŠ /ç·¨é›†
];

final List<String> _regions = [
  'åŒ—æµ·é“',
  // ... è¿½åŠ /ç·¨é›†
];
```

---

#### `presentation/pages/notice_screen.dart`
**å½¹å‰²**: é€šçŸ¥è¨­å®šç”»é¢

**ä½¿ç”¨ã—ã¦ã„ã‚‹ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼**:
```dart
// lib/feature/settings/presentation/pages/notice_screen.dart:XX
ref.watch(notificationSettingsProvider)  // é€šçŸ¥è¨­å®šã®çŠ¶æ…‹
ref.read(notificationSettingsProvider.notifier)  // é€šçŸ¥è¨­å®šã®æ“ä½œ
```

**ä¸»ãªæ©Ÿèƒ½**:
1. **é€šçŸ¥ON/OFF**: `SwitchListTile`ã§åˆ‡ã‚Šæ›¿ãˆ
2. **æ™‚åˆ»é¸æŠ**: `TimePickerDialog`ã§æ™‚åˆ»ã‚’é¸æŠ
   - 6:00ã€œ23:00ã®ç¯„å›²åˆ¶é™ã‚ã‚Š
3. **ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸é¸æŠ**: ãƒ©ã‚¸ã‚ªãƒœã‚¿ãƒ³ã§é¸æŠ
4. **ãƒ†ã‚¹ãƒˆé€šçŸ¥**: å³åº§ã«é€šçŸ¥ã‚’é€ä¿¡

**ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºãƒã‚¤ãƒ³ãƒˆ**:
```dart
// lib/feature/settings/models/notification_settings.dart:XX
// é€šçŸ¥ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¿½åŠ /ç·¨é›†
class NotificationMessages {
  static const List<String> messages = [
    'ãƒˆãƒ”ãƒƒã‚¯ãŒå±Šã„ã¦ã„ã¾ã™',
    'ä»Šæ—¥ã®ãƒˆãƒ”ãƒƒã‚¯ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¾ã—ã‚‡ã†',
    // ... æ–°ã—ã„ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¿½åŠ 
  ];
}
```

---

#### `presentation/widgets/setting_item.dart`
**å½¹å‰²**: è¨­å®šé …ç›®ã®å†åˆ©ç”¨å¯èƒ½ãªã‚¦ã‚£ã‚¸ã‚§ãƒƒãƒˆ

**æä¾›ã—ã¦ã„ã‚‹ã‚¦ã‚£ã‚¸ã‚§ãƒƒãƒˆ**:
1. `SettingItem`: é€šå¸¸ã®è¨­å®šé …ç›®
   ```dart
   SettingItem(
     icon: Icons.notifications,
     title: 'é€šçŸ¥',
     subtitle: 'é€šçŸ¥è¨­å®šã‚’å¤‰æ›´',
     iconColor: Colors.orange,
     onTap: () => context.push('/notice'),
   )
   ```

2. `SettingSection`: ã‚»ã‚¯ã‚·ãƒ§ãƒ³ãƒ˜ãƒƒãƒ€ãƒ¼
   ```dart
   SettingSection(title: 'ã‚¢ãƒ—ãƒªè¨­å®š')
   ```

3. `DangerSettingItem`: å±é™ºãªæ“ä½œç”¨ï¼ˆèµ¤è‰²ï¼‰
   ```dart
   DangerSettingItem(
     icon: Icons.logout,
     title: 'ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ',
     onTap: _logout,
   )
   ```

---

### ğŸ”§ Providerså±¤ï¼ˆçŠ¶æ…‹ç®¡ç†ï¼‰

#### `providers/profile_edit_provider.dart`
**å½¹å‰²**: ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ç·¨é›†ãƒ•ã‚©ãƒ¼ãƒ ã®çŠ¶æ…‹ç®¡ç†

**ã‚¯ãƒ©ã‚¹**:
1. `ProfileEditNotifier extends Notifier<ProfileEditState>`
   - ãƒ•ã‚©ãƒ¼ãƒ ã®çŠ¶æ…‹ã‚’ç®¡ç†
   - ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œ
   - ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ç·¨é›†ã®åˆ‡ã‚Šæ›¿ãˆ

2. `ProfileSaveNotifier extends Notifier<AsyncValue<void>>`
   - ä¿å­˜å‡¦ç†ã®å®Ÿè¡Œ
   - ProfileUpdateNotifierã‚’å‘¼ã³å‡ºã—

**ä¸»ãªãƒ¡ã‚½ãƒƒãƒ‰**:
```dart
// lib/feature/settings/providers/profile_edit_provider.dart:XX
class ProfileEditNotifier {
  void updateNickname(String nickname)      // ãƒ‹ãƒƒã‚¯ãƒãƒ¼ãƒ æ›´æ–°
  void updateAgeRange(String? ageRange)     // å¹´ä»£æ›´æ–°
  void updateRegion(String? region)         // åœ°åŸŸæ›´æ–°
  void updateSelectedImage(File? image)     // ç”»åƒæ›´æ–°
  void togglePasswordEditing()              // ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ç·¨é›†åˆ‡ã‚Šæ›¿ãˆ
  void updateCurrentPassword(String password)  // ç¾åœ¨ã®ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰
  void updateNewPassword(String password)   // æ–°ã—ã„ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰
  void updateConfirmPassword(String password)  // ç¢ºèªç”¨ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰
  ProfileEditValidation validate()          // ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³
  void clearPasswordFields()                // ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚¯ãƒªã‚¢
}
```

**ä¾å­˜é–¢ä¿‚**:
- `ProfileEditState`: çŠ¶æ…‹ã‚’ä¿æŒã™ã‚‹Freezedã‚¯ãƒ©ã‚¹
- `ProfileUpdateNotifier`: å®Ÿéš›ã®æ›´æ–°å‡¦ç†ã‚’å®Ÿè¡Œ

---

#### `providers/profile_update_provider.dart`
**å½¹å‰²**: ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«æ›´æ–°ã®ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯

**ã‚¯ãƒ©ã‚¹**: `ProfileUpdateNotifier`

**ä¸»ãªãƒ¡ã‚½ãƒƒãƒ‰**:
```dart
// lib/feature/settings/providers/profile_update_provider.dart:13
Future<void> updateProfile({
  required String userId,
  required String nickname,
  String? iconUrl,
  String? ageRange,
  String? region,
})

// lib/feature/settings/providers/profile_update_provider.dart:42
Future<String> updateProfileImage({
  required String userId,
  required File imageFile,
})

// lib/feature/settings/providers/profile_update_provider.dart:59
Future<void> updateEmail({
  required String userId,
  required String newEmail,
  required String currentPassword,
})

// lib/feature/settings/providers/profile_update_provider.dart:90
Future<void> updatePassword({
  required String currentPassword,
  required String newPassword,
})
```

**ä¾å­˜ã—ã¦ã„ã‚‹ä»–ãƒ•ã‚£ãƒ¼ãƒãƒ£ãƒ¼ã®ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼**:
```dart
// lib/feature/settings/providers/profile_update_provider.dart:20,64,94
ref.read(authServiceProvider)      // èªè¨¼ã‚µãƒ¼ãƒ“ã‚¹

// lib/feature/settings/providers/profile_update_provider.dart:47
ref.read(storageServiceProvider)   // ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã‚µãƒ¼ãƒ“ã‚¹

// lib/feature/settings/providers/profile_update_provider.dart:38,86
ref.invalidate(currentUserProvider) // ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ã®æ›´æ–°
```

**å‡¦ç†ãƒ•ãƒ­ãƒ¼**:
1. authServiceProviderã‹ã‚‰ç¾åœ¨ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ã‚’å–å¾—
2. UserModelã®copyWithã§æ–°ã—ã„æƒ…å ±ã‚’ä½œæˆ
3. authServiceProviderã§æ›´æ–°
4. currentUserProviderã‚’ç„¡åŠ¹åŒ–ã—ã¦UIã«åæ˜ 

---

#### `providers/notification_provider.dart`
**å½¹å‰²**: é€šçŸ¥è¨­å®šã®çŠ¶æ…‹ç®¡ç†ã¨ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒªãƒ³ã‚°

**ã‚¯ãƒ©ã‚¹**: `NotificationSettingsNotifier extends Notifier<NotificationSettings>`

**ä¸»ãªãƒ¡ã‚½ãƒƒãƒ‰**:
```dart
// lib/feature/settings/providers/notification_provider.dart:XX
Future<void> toggleNotification(bool isEnabled)  // ON/OFFåˆ‡ã‚Šæ›¿ãˆ
Future<void> updateTime(int hour, int minute)    // æ™‚åˆ»å¤‰æ›´
Future<void> updateMessage(String message)       // ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å¤‰æ›´
Future<void> sendTestNotification()              // ãƒ†ã‚¹ãƒˆé€šçŸ¥
Future<List<PendingNotificationRequest>> getPendingNotifications()  // ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ç¢ºèª
```

**ä¾å­˜é–¢ä¿‚**:
```dart
// lib/feature/settings/providers/notification_provider.dart:XX
final notificationService = ref.read(notificationServiceProvider)
// SharedPreferencesã‚’ä½¿ç”¨ï¼ˆ_loadSettings, _saveSettingsï¼‰
```

**è¨­å®šã®æ°¸ç¶šåŒ–**:
- SharedPreferencesã‚’ä½¿ç”¨
- ã‚¢ãƒ—ãƒªå†èµ·å‹•å¾Œã‚‚è¨­å®šã‚’ä¿æŒ
- è¨­å®šå¤‰æ›´æ™‚ã«è‡ªå‹•ã§é€šçŸ¥ã‚’å†ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«

**åˆæœŸåŒ–ãƒ•ãƒ­ãƒ¼**:
```
1. build()ã§åˆæœŸè¨­å®šã‚’èª­ã¿è¾¼ã¿
   â†“
2. _initializeNotificationService()ã§NotificationServiceã‚’åˆæœŸåŒ–
   â†“
3. _loadSettings()ã§SharedPreferencesã‹ã‚‰è¨­å®šã‚’èª­ã¿è¾¼ã¿
   â†“
4. é€šçŸ¥ãŒæœ‰åŠ¹ãªã‚‰è‡ªå‹•ã§ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«
```

---

#### `providers/profile_edit_state.dart`
**å½¹å‰²**: ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ç·¨é›†ã®çŠ¶æ…‹å®šç¾©

**ã‚¯ãƒ©ã‚¹**:
```dart
// lib/feature/settings/providers/profile_edit_state.dart:XX
@freezed
class ProfileEditState with _$ProfileEditState {
  const factory ProfileEditState({
    required String nickname,
    String? ageRange,
    String? region,
    File? selectedImage,
    @Default(false) bool isEditingPassword,
    @Default('') String currentPassword,
    @Default('') String newPassword,
    @Default('') String confirmPassword,
    @Default(ProfileEditValidation.valid()) ProfileEditValidation validation,
  }) = _ProfileEditState;

  factory ProfileEditState.fromUser(UserModel user) = ...;
}

@freezed
class ProfileEditValidation with _$ProfileEditValidation {
  const factory ProfileEditValidation({
    String? nicknameError,
    String? passwordError,
  }) = _ProfileEditValidation;

  const factory ProfileEditValidation.valid() = ...;
}
```

**ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ­ã‚¸ãƒƒã‚¯**:
- ãƒ‹ãƒƒã‚¯ãƒãƒ¼ãƒ ã®é•·ã•ãƒã‚§ãƒƒã‚¯
- ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã®ä¸€è‡´ç¢ºèª
- ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã®å¼·åº¦ãƒã‚§ãƒƒã‚¯

---

### ğŸ› ï¸ Serviceså±¤ï¼ˆãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ï¼‰

#### `services/notification_service.dart`
**å½¹å‰²**: flutter_local_notificationsã¨FCMã‚’ä½¿ã£ãŸé€šçŸ¥æ©Ÿèƒ½ï¼ˆã‚·ãƒ³ã‚°ãƒ«ãƒˆãƒ³ï¼‰

**ã‚¯ãƒ©ã‚¹**: `NotificationService`ï¼ˆã‚·ãƒ³ã‚°ãƒ«ãƒˆãƒ³ãƒ‘ã‚¿ãƒ¼ãƒ³ï¼‰

**ä¸»ãªãƒ¡ã‚½ãƒƒãƒ‰**:
```dart
// lib/feature/settings/services/notification_service.dart:33
Future<void> initialize()  // é€šçŸ¥ã‚µãƒ¼ãƒ“ã‚¹ã‚’åˆæœŸåŒ–

// lib/feature/settings/services/notification_service.dart:216
Future<bool> requestPermission()  // é€šçŸ¥æ¨©é™ã‚’ãƒªã‚¯ã‚¨ã‚¹ãƒˆ

// lib/feature/settings/services/notification_service.dart:243
Future<void> scheduleDailyNotification(NotificationSettings settings)  // æ¯æ—¥ã®é€šçŸ¥

// lib/feature/settings/services/notification_service.dart:294
Future<void> cancelAllNotifications()  // ã™ã¹ã¦ã®é€šçŸ¥ã‚’ã‚­ãƒ£ãƒ³ã‚»ãƒ«

// lib/feature/settings/services/notification_service.dart:299
Future<void> showTestNotification(String message)  // ãƒ†ã‚¹ãƒˆé€šçŸ¥

// lib/feature/settings/services/notification_service.dart:177
Future<void> showMatchNotification({...})  // ãƒãƒƒãƒãƒ³ã‚°é€šçŸ¥

// lib/feature/settings/services/notification_service.dart:138
Future<void> saveFcmToken(String userId)  // FCMãƒˆãƒ¼ã‚¯ãƒ³ä¿å­˜

// lib/feature/settings/services/notification_service.dart:167
Future<void> removeFcmToken(String userId)  // FCMãƒˆãƒ¼ã‚¯ãƒ³å‰Šé™¤

// lib/feature/settings/services/notification_service.dart:323
Future<List<PendingNotificationRequest>> getPendingNotifications()  // ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ç¢ºèª
```

**ä¾å­˜ã™ã‚‹ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸**:
```dart
// lib/feature/settings/services/notification_service.dart:1-5
import 'package:flutter_local_notifications/flutter_local_notifications.dart';
import 'package:firebase_messaging/firebase_messaging.dart';
import 'package:cloud_firestore/cloud_firestore.dart';
import 'package:timezone/timezone.dart' as tz;
```

**é€šçŸ¥ã®ç¨®é¡**:
1. **ãƒ­ãƒ¼ã‚«ãƒ«é€šçŸ¥ï¼ˆæ¯æ—¥ï¼‰**
   - é€šçŸ¥ID: 0
   - ãƒãƒ£ãƒ³ãƒãƒ«: 'daily_notification'
   - ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«: æ¯æ—¥æŒ‡å®šæ™‚åˆ»

2. **ãƒãƒƒãƒãƒ³ã‚°é€šçŸ¥ï¼ˆFCMï¼‰**
   - é€šçŸ¥ID: 100
   - ãƒãƒ£ãƒ³ãƒãƒ«: 'match_notification'
   - ãƒšã‚¤ãƒ­ãƒ¼ãƒ‰: matchId

3. **ãƒ†ã‚¹ãƒˆé€šçŸ¥**
   - é€šçŸ¥ID: 999
   - ãƒãƒ£ãƒ³ãƒãƒ«: 'test_notification'
   - å³åº§ã«è¡¨ç¤º

**FCMã®å‡¦ç†ãƒ•ãƒ­ãƒ¼**:
```
1. initialize()ã§FCMã‚’åˆæœŸåŒ–
   â†“
2. requestPermission()ã§æ¨©é™å–å¾—
   â†“
3. getToken()ã§FCMãƒˆãƒ¼ã‚¯ãƒ³å–å¾—
   â†“
4. saveFcmToken()ã§Firestoreã«ä¿å­˜
   â†“
5. ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å—ä¿¡æ™‚:
   - ãƒ•ã‚©ã‚¢ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰: _handleForegroundMessage()
   - ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰: firebaseMessagingBackgroundHandler()
   - é€šçŸ¥ã‚¿ãƒƒãƒ—: _handleMessageOpenedApp()
```

**é€šçŸ¥ã®ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º**:
```dart
// lib/feature/settings/services/notification_service.dart:273
AndroidNotificationDetails(
  'daily_notification',           // ãƒãƒ£ãƒ³ãƒãƒ«ID
  'æ¯æ—¥ã®é€šçŸ¥',                    // ãƒãƒ£ãƒ³ãƒãƒ«å
  channelDescription: 'æ¯æ—¥æ±ºã¾ã£ãŸæ™‚é–“ã«é€šçŸ¥ã‚’å—ã‘å–ã‚Šã¾ã™',
  importance: Importance.high,    // é‡è¦åº¦
  priority: Priority.high,        // å„ªå…ˆåº¦
  icon: '@mipmap/ic_launcher',    // ã‚¢ã‚¤ã‚³ãƒ³
)
```

---

### ğŸ“¦ Modelså±¤ï¼ˆãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«ï¼‰

#### `models/notification_settings.dart`
**å½¹å‰²**: é€šçŸ¥è¨­å®šã®ãƒ‡ãƒ¼ã‚¿æ§‹é€ 

**ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰**:
```dart
// lib/feature/settings/models/notification_settings.dart:XX
@freezed
class NotificationSettings with _$NotificationSettings {
  const factory NotificationSettings({
    @Default(true) bool isEnabled,       // é€šçŸ¥ã®ON/OFF
    @Default(9) int hour,                // é€šçŸ¥æ™‚åˆ»ï¼ˆæ™‚ï¼‰
    @Default(0) int minute,              // é€šçŸ¥æ™‚åˆ»ï¼ˆåˆ†ï¼‰
    @Default('ãƒˆãƒ”ãƒƒã‚¯ãŒå±Šã„ã¦ã„ã¾ã™') String message,  // é€šçŸ¥ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
  }) = _NotificationSettings;

  factory NotificationSettings.fromJson(Map<String, dynamic> json) =>
      _$NotificationSettingsFromJson(json);
}
```

**NotificationMessagesï¼ˆå®šæ•°ï¼‰**:
```dart
// lib/feature/settings/models/notification_settings.dart:XX
class NotificationMessages {
  static const List<String> messages = [
    'ãƒˆãƒ”ãƒƒã‚¯ãŒå±Šã„ã¦ã„ã¾ã™',
    'ä»Šæ—¥ã®ãƒˆãƒ”ãƒƒã‚¯ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¾ã—ã‚‡ã†',
    'æ–°ã—ã„ãŠé¡Œã«æŒ‘æˆ¦ã—ã¦ã¿ã¾ã›ã‚“ã‹',
    'ã¿ã‚“ãªã®æ„è¦‹ã‚’è¦‹ã¦ã¿ã‚ˆã†',
    'ã‚ãªãŸã®æ„è¦‹ã‚’èã‹ã›ã¦ãã ã•ã„',
  ];
}
```

**ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã®å¤‰æ›´**:
```dart
// ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®é€šçŸ¥æ™‚åˆ»ã‚’å¤‰æ›´ã—ãŸã„å ´åˆ
@Default(8) int hour,  // æœ8æ™‚ã«å¤‰æ›´
```

---

## ç”»é¢ä¸€è¦§

### 1. è¨­å®šç”»é¢ï¼ˆsettings_screen.dartï¼‰
**ãƒ‘ã‚¹**: `/settings`
**èª¬æ˜**: ã‚¢ãƒ—ãƒªã®å…¨è¨­å®šé …ç›®ã‚’ä¸€è¦§è¡¨ç¤ºã™ã‚‹ãƒ¡ã‚¤ãƒ³ç”»é¢

**ã‚»ã‚¯ã‚·ãƒ§ãƒ³æ§‹æˆ**:
- **ã‚¢ã‚«ã‚¦ãƒ³ãƒˆ**: ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ç·¨é›†
- **ã‚¢ãƒ—ãƒªè¨­å®š**: é€šçŸ¥ã€è¡¨ç¤ºã€ãã®ä»–
- **ã‚µãƒãƒ¼ãƒˆ**: ãƒ˜ãƒ«ãƒ—ã€åŸºæœ¬æƒ…å ±
- **ã‚¢ã‚«ã‚¦ãƒ³ãƒˆæ“ä½œ**: ãƒ­ã‚°ã‚¢ã‚¦ãƒˆã€ã‚¢ã‚«ã‚¦ãƒ³ãƒˆå‰Šé™¤

**ä¸»ãªæ©Ÿèƒ½**:
- ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ç”»åƒã®è¡¨ç¤º
- å„ç¨®è¨­å®šé …ç›®ã¸ã®é·ç§»
- ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ/ã‚¢ã‚«ã‚¦ãƒ³ãƒˆå‰Šé™¤ã®ç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°

---

### 2. ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ç·¨é›†ç”»é¢ï¼ˆprofile_screen.dartï¼‰
**ãƒ‘ã‚¹**: `/profile`ï¼ˆè¨­å®šç”»é¢ â†’ ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ã‹ã‚‰é·ç§»ï¼‰
**èª¬æ˜**: ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ã‚’ç·¨é›†ã™ã‚‹ç”»é¢

**ç·¨é›†å¯èƒ½ãªé …ç›®**:
- ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ç”»åƒï¼ˆã‚®ãƒ£ãƒ©ãƒªãƒ¼/ã‚«ãƒ¡ãƒ©ï¼‰
- ãƒ‹ãƒƒã‚¯ãƒãƒ¼ãƒ 
- ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹
- å¹´ä»£ï¼ˆ10æ­³æœªæº€ã€œ90ä»£ï¼‰
- åœ°åŸŸï¼ˆ47éƒ½é“åºœçœŒï¼‰
- ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ï¼ˆç¾åœ¨ã®ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã§å†èªè¨¼ãŒå¿…è¦ï¼‰

**ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³**:
- ãƒ‹ãƒƒã‚¯ãƒãƒ¼ãƒ : 1æ–‡å­—ä»¥ä¸Šå¿…é ˆ
- ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰: æ–°ã—ã„ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã¨ç¢ºèªç”¨ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒä¸€è‡´
- ãƒ¡ãƒ¼ãƒ«å¤‰æ›´: ç¾åœ¨ã®ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã§å†èªè¨¼

---

### 3. é€šçŸ¥è¨­å®šç”»é¢ï¼ˆnotice_screen.dartï¼‰
**ãƒ‘ã‚¹**: `/notice`ï¼ˆè¨­å®šç”»é¢ â†’ é€šçŸ¥ã‹ã‚‰é·ç§»ï¼‰
**èª¬æ˜**: ãƒ—ãƒƒã‚·ãƒ¥é€šçŸ¥ã®è¨­å®šã‚’è¡Œã†ç”»é¢

**è¨­å®šé …ç›®**:
- é€šçŸ¥ã®ON/OFF
- é€šçŸ¥æ™‚åˆ»ï¼ˆ6:00ã€œ23:00ï¼‰
- é€šçŸ¥ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ï¼ˆ5ç¨®é¡ã®ãƒ—ãƒªã‚»ãƒƒãƒˆï¼‰
- ãƒ†ã‚¹ãƒˆé€šçŸ¥é€ä¿¡

**å‹•ä½œ**:
- è¨­å®šå¤‰æ›´æ™‚ã«ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§ä¿å­˜
- é€šçŸ¥ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã®è‡ªå‹•æ›´æ–°
- ãƒ†ã‚¹ãƒˆé€šçŸ¥ã§å‹•ä½œç¢ºèªå¯èƒ½

---

## ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºæ–¹æ³•

### 1. é€šçŸ¥æ™‚åˆ»ã®ç¯„å›²ã‚’å¤‰æ›´

**ãƒ•ã‚¡ã‚¤ãƒ«**: `presentation/pages/notice_screen.dart`

```dart
// ç¾åœ¨: 6:00ã€œ23:00
if (picked.hour >= 6 && picked.hour <= 23) {
  // OK
}

// å¤‰æ›´ä¾‹: 0:00ã€œ23:59ï¼ˆ24æ™‚é–“å¯¾å¿œï¼‰
if (picked.hour >= 0 && picked.hour <= 23) {
  // OK
}
```

---

### 2. é€šçŸ¥ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®è¿½åŠ 

**ãƒ•ã‚¡ã‚¤ãƒ«**: `models/notification_settings.dart`

```dart
class NotificationMessages {
  static const List<String> messages = [
    'ãƒˆãƒ”ãƒƒã‚¯ãŒå±Šã„ã¦ã„ã¾ã™',
    'ä»Šæ—¥ã®ãƒˆãƒ”ãƒƒã‚¯ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¾ã—ã‚‡ã†',
    'æ–°ã—ã„ãŠé¡Œã«æŒ‘æˆ¦ã—ã¦ã¿ã¾ã›ã‚“ã‹',
    'ã¿ã‚“ãªã®æ„è¦‹ã‚’è¦‹ã¦ã¿ã‚ˆã†',
    'ã‚ãªãŸã®æ„è¦‹ã‚’èã‹ã›ã¦ãã ã•ã„',
    // ã“ã“ã«æ–°ã—ã„ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¿½åŠ 
    'ä»Šã™ããƒã‚§ãƒƒã‚¯ï¼',
    'æ–°ç€é€šçŸ¥ã§ã™',
  ];
}
```

---

### 3. ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«é …ç›®ã®è¿½åŠ 

**ãƒ•ã‚¡ã‚¤ãƒ«**: `presentation/pages/profile_screen.dart`

**æ‰‹é †**:
1. UIã«æ–°ã—ã„ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’è¿½åŠ 
2. `ProfileEditState`ã«æ–°ã—ã„ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’è¿½åŠ 
3. `ProfileEditNotifier`ã«æ›´æ–°ãƒ¡ã‚½ãƒƒãƒ‰ã‚’è¿½åŠ 
4. `ProfileUpdateNotifier`ã®`updateProfile`ãƒ¡ã‚½ãƒƒãƒ‰ã‚’æ›´æ–°
5. `UserModel`ã«æ–°ã—ã„ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’è¿½åŠ ï¼ˆ`auth/models/user/user_model.dart`ï¼‰

**ä¾‹**: é›»è©±ç•ªå·ã‚’è¿½åŠ 
```dart
// 1. ProfileEditStateã«è¿½åŠ 
@freezed
class ProfileEditState with _$ProfileEditState {
  const factory ProfileEditState({
    required String nickname,
    String? phone,  // è¿½åŠ 
    // ...
  }) = _ProfileEditState;
}

// 2. UIã«è¿½åŠ 
_buildTextField(
  controller: _phoneController,
  label: 'é›»è©±ç•ªå·',
  icon: Icons.phone,
  keyboardType: TextInputType.phone,
),

// 3. ä¿å­˜å‡¦ç†ã«è¿½åŠ 
await profileUpdateNotifier.updateProfile(
  userId: user.id,
  nickname: newNickname,
  phone: state.phone,  // è¿½åŠ 
);
```

---

### 4. è¨­å®šç”»é¢ã«æ–°ã—ã„ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’è¿½åŠ 

**ãƒ•ã‚¡ã‚¤ãƒ«**: `presentation/pages/settings_screen.dart`

```dart
// æ–°ã—ã„ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’è¿½åŠ 
const SettingSection(title: 'æ–°ã—ã„ã‚»ã‚¯ã‚·ãƒ§ãƒ³'),
SettingItem(
  icon: Icons.new_icon,
  title: 'æ–°ã—ã„è¨­å®šé …ç›®',
  subtitle: 'èª¬æ˜æ–‡',
  iconColor: Colors.green,
  onTap: () {
    context.push('/new-route');
  },
),
```

---

## æ–°ã—ã„è¨­å®šé …ç›®ã®è¿½åŠ æ–¹æ³•

### ä¾‹: è¨€èªè¨­å®šæ©Ÿèƒ½ã‚’è¿½åŠ 

#### ã‚¹ãƒ†ãƒƒãƒ—1: ãƒ¢ãƒ‡ãƒ«ã‚’ä½œæˆ
```dart
// models/language_settings.dart
@freezed
class LanguageSettings with _$LanguageSettings {
  const factory LanguageSettings({
    @Default('ja') String language,
  }) = _LanguageSettings;

  factory LanguageSettings.fromJson(Map<String, dynamic> json) =>
      _$LanguageSettingsFromJson(json);
}

// ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã§å®Ÿè¡Œ
flutter pub run build_runner build --delete-conflicting-outputs
```

#### ã‚¹ãƒ†ãƒƒãƒ—2: ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ã‚’ä½œæˆ
```dart
// providers/language_provider.dart
final languageProvider = StateNotifierProvider<LanguageNotifier, String>(
  (ref) => LanguageNotifier(),
);

class LanguageNotifier extends StateNotifier<String> {
  LanguageNotifier() : super('ja') {
    _loadLanguage();
  }

  Future<void> _loadLanguage() async {
    final prefs = await SharedPreferences.getInstance();
    state = prefs.getString('language') ?? 'ja';
  }

  Future<void> changeLanguage(String newLanguage) async {
    state = newLanguage;
    final prefs = await SharedPreferences.getInstance();
    await prefs.setString('language', newLanguage);
  }
}
```

#### ã‚¹ãƒ†ãƒƒãƒ—3: ç”»é¢ã‚’ä½œæˆ
```dart
// presentation/pages/language_screen.dart
class LanguageScreen extends ConsumerWidget {
  const LanguageScreen({super.key});

  @override
  Widget build(BuildContext context, WidgetRef ref) {
    final currentLanguage = ref.watch(languageProvider);

    return Scaffold(
      appBar: AppBar(title: const Text('è¨€èªè¨­å®š')),
      body: ListView(
        children: [
          RadioListTile<String>(
            title: const Text('æ—¥æœ¬èª'),
            value: 'ja',
            groupValue: currentLanguage,
            onChanged: (value) {
              if (value != null) {
                ref.read(languageProvider.notifier).changeLanguage(value);
              }
            },
          ),
          RadioListTile<String>(
            title: const Text('English'),
            value: 'en',
            groupValue: currentLanguage,
            onChanged: (value) {
              if (value != null) {
                ref.read(languageProvider.notifier).changeLanguage(value);
              }
            },
          ),
        ],
      ),
    );
  }
}
```

#### ã‚¹ãƒ†ãƒƒãƒ—4: ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã‚’è¿½åŠ 
```dart
// core/route/app_router.dart
GoRoute(
  path: '/language',
  pageBuilder: (context, state) => const NoTransitionPage(
    child: LanguageScreen(),
  ),
),
```

#### ã‚¹ãƒ†ãƒƒãƒ—5: è¨­å®šç”»é¢ã«è¿½åŠ 
```dart
// presentation/pages/settings_screen.dart
SettingItem(
  icon: Icons.language,
  title: 'è¨€èªè¨­å®š',
  subtitle: 'è¡¨ç¤ºè¨€èªã‚’å¤‰æ›´',
  iconColor: Colors.purple,
  onTap: () {
    context.push('/language');
  },
),
```

---

## ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### é€šçŸ¥ãŒå±Šã‹ãªã„å ´åˆ

1. **é€šçŸ¥æ¨©é™ã‚’ç¢ºèª**
   ```dart
   // notification_service.dartã§ãƒªã‚¯ã‚¨ã‚¹ãƒˆã—ã¦ã„ã‚‹ã‹ç¢ºèª
   await requestPermission();
   ```

2. **é€šçŸ¥ãŒã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª**
   ```dart
   final pending = await _notificationService.getPendingNotifications();
   print('Pending notifications: ${pending.length}');
   ```

3. **ãƒ‡ãƒã‚¤ã‚¹è¨­å®šã‚’ç¢ºèª**
   - Android: è¨­å®š â†’ ã‚¢ãƒ—ãƒª â†’ é€šçŸ¥ â†’ ã‚¢ãƒ—ãƒªå
   - iOS: è¨­å®š â†’ é€šçŸ¥ â†’ ã‚¢ãƒ—ãƒªå

4. **ã‚¿ã‚¤ãƒ ã‚¾ãƒ¼ãƒ³è¨­å®šã‚’ç¢ºèª**
   - `notification_service.dart`ã§`Asia/Tokyo`ã«è¨­å®šã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª

---

### ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«æ›´æ–°ãŒå¤±æ•—ã™ã‚‹å ´åˆ

1. **ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ç¢ºèª**
   ```dart
   try {
     await profileUpdateNotifier.updateProfile(...);
   } catch (e) {
     print('Error: $e');  // ã‚¨ãƒ©ãƒ¼å†…å®¹ã‚’ç¢ºèª
   }
   ```

2. **Firebaseæ¨©é™ã‚’ç¢ºèª**
   - Firestore Rulesã§æ›¸ãè¾¼ã¿æ¨©é™ãŒã‚ã‚‹ã‹
   - Storage Rulesã§ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰æ¨©é™ãŒã‚ã‚‹ã‹

3. **ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯æ¥ç¶šã‚’ç¢ºèª**

4. **å†èªè¨¼ãŒå¿…è¦ãªæ“ä½œã‚’ç¢ºèª**
   - ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹å¤‰æ›´
   - ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰å¤‰æ›´

---

### Freezedã®å†ç”ŸæˆãŒå¿…è¦ãªå ´åˆ

```bash
flutter pub run build_runner build --delete-conflicting-outputs
```

**è‡ªå‹•ç”Ÿæˆã•ã‚Œã‚‹ãƒ•ã‚¡ã‚¤ãƒ«**:
- `*.freezed.dart`
- `*.g.dart`

---

### FCMãƒˆãƒ¼ã‚¯ãƒ³ãŒå–å¾—ã§ããªã„å ´åˆï¼ˆiOSï¼‰

**åŸå› **: APNSãƒˆãƒ¼ã‚¯ãƒ³ãŒã¾ã æº–å‚™ã§ãã¦ã„ãªã„

**è§£æ±ºæ–¹æ³•**:
- ã‚¨ãƒ©ãƒ¼ã¯ç„¡è¦–ã—ã¦OK
- `onTokenRefresh`ãƒªã‚¹ãƒŠãƒ¼ã§å¾Œã§è‡ªå‹•çš„ã«å–å¾—ã•ã‚Œã‚‹
- ã‚¢ãƒ—ãƒªã‚’å†èµ·å‹•ã™ã‚‹ã¨å–å¾—ã•ã‚Œã‚‹ã“ã¨ãŒå¤šã„

```dart
// lib/feature/settings/services/notification_service.dart:80-92
try {
  _fcmToken = await _messaging.getToken();
} on FirebaseException catch (e) {
  if (e.code == 'apns-token-not-set') {
    // ã“ã‚Œã¯æ­£å¸¸ãªå‹•ä½œ
    debugPrint('APNSãƒˆãƒ¼ã‚¯ãƒ³ãŒã¾ã æº–å‚™ã§ãã¦ã„ã¾ã›ã‚“');
  }
}
```

---

## ä¾å­˜ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®è©³ç´°

```yaml
dependencies:
  # çŠ¶æ…‹ç®¡ç†
  flutter_riverpod: ^3.0.0       # RiverpodçŠ¶æ…‹ç®¡ç†

  # ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«
  freezed_annotation: ^2.4.1     # Freezedã‚¢ãƒãƒ†ãƒ¼ã‚·ãƒ§ãƒ³
  json_annotation: ^4.8.1        # JSONå¤‰æ›

  # ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸
  shared_preferences: ^2.2.2     # ã‚­ãƒ¼/ãƒãƒªãƒ¥ãƒ¼ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸

  # ç”»åƒé¸æŠ
  image_picker: æœ€æ–°ç‰ˆ            # ã‚®ãƒ£ãƒ©ãƒªãƒ¼/ã‚«ãƒ¡ãƒ©ã‹ã‚‰ç”»åƒé¸æŠ

  # é€šçŸ¥
  flutter_local_notifications: ^18.0.1  # ãƒ­ãƒ¼ã‚«ãƒ«é€šçŸ¥
  timezone: ^0.9.2               # ã‚¿ã‚¤ãƒ ã‚¾ãƒ¼ãƒ³ç®¡ç†

  # Firebase
  firebase_auth: æœ€æ–°ç‰ˆ           # èªè¨¼
  firebase_messaging: æœ€æ–°ç‰ˆ      # FCM
  cloud_firestore: æœ€æ–°ç‰ˆ         # ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹
  firebase_storage: æœ€æ–°ç‰ˆ        # ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸

dev_dependencies:
  # ã‚³ãƒ¼ãƒ‰ç”Ÿæˆ
  build_runner: ^2.4.6           # ãƒ“ãƒ«ãƒ‰ãƒ©ãƒ³ãƒŠãƒ¼
  freezed: ^2.4.5                # Freezedã‚³ãƒ¼ãƒ‰ç”Ÿæˆ
  json_serializable: ^6.7.1      # JSONå¤‰æ›ã‚³ãƒ¼ãƒ‰ç”Ÿæˆ
```

---

## å‚è€ƒãƒªãƒ³ã‚¯

- [Flutter Riverpodå…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ](https://riverpod.dev/)
- [Freezedå…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ](https://pub.dev/packages/freezed)
- [flutter_local_notificationså…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ](https://pub.dev/packages/flutter_local_notifications)
- [SharedPreferenceså…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ](https://pub.dev/packages/shared_preferences)
- [Firebase Messagingå…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ](https://firebase.google.com/docs/cloud-messaging)

---

## æ›´æ–°å±¥æ­´

- **2025-12-05**: READMEã®å¤§å¹…æ›´æ–°
  - ä¾å­˜é–¢ä¿‚ã®è©³ç´°ã‚’è¿½åŠ 
  - ã‚¯ãƒ©ã‚¹å›³ã¨é–¢ä¿‚æ€§ã‚’è¿½åŠ 
  - ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼ã®èª¬æ˜ã‚’è¿½åŠ 
  - å„ãƒ•ã‚¡ã‚¤ãƒ«ã®è¡Œç•ªå·å‚ç…§ã‚’è¿½åŠ 
  - FCMæ©Ÿèƒ½ã®èª¬æ˜ã‚’è¿½åŠ 

- **2025-10-30**: åˆç‰ˆä½œæˆ
  - ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ç·¨é›†æ©Ÿèƒ½ã®è¿½åŠ 
  - é€šçŸ¥è¨­å®šæ©Ÿèƒ½ã®è¿½åŠ 
  - å¹´ä»£ãƒ»åœ°åŸŸé¸æŠæ©Ÿèƒ½ã®è¿½åŠ 

---

## è²¢çŒ®è€…å‘ã‘

æ–°ã—ã„æ©Ÿèƒ½ã‚’è¿½åŠ ã™ã‚‹å ´åˆã¯ã€ä»¥ä¸‹ã®ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³ã«å¾“ã£ã¦ãã ã•ã„ï¼š

1. **å‘½åè¦å‰‡**: `feature_screen.dart`ã®ã‚ˆã†ã«ã‚¹ãƒãƒ¼ã‚¯ã‚±ãƒ¼ã‚¹ã‚’ä½¿ç”¨
2. **çŠ¶æ…‹ç®¡ç†**: Riverpodã‚’ä½¿ç”¨
3. **ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«**: Freezedã‚’ä½¿ç”¨ã—ã¦ã‚¤ãƒŸãƒ¥ãƒ¼ã‚¿ãƒ–ãƒ«ã«
4. **ãƒ•ã‚¡ã‚¤ãƒ«é…ç½®**: é©åˆ‡ãªãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªï¼ˆmodels/providers/presentation/servicesï¼‰ã«é…ç½®
5. **ä¾å­˜é–¢ä¿‚**: å¿…è¦æœ€å°é™ã«æŠ‘ãˆã€å¾ªç’°å‚ç…§ã‚’é¿ã‘ã‚‹
6. **ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ**: ã“ã®README.mdã‚’æ›´æ–°
7. **ãƒ†ã‚¹ãƒˆ**: å¯èƒ½ãªé™ã‚Šãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆã‚’è¿½åŠ 

### ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¦ç´„
- ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ã¯å¸¸ã«Riverpodã‚’ä½¿ç”¨
- å¤–éƒ¨APIã¨ã®é€šä¿¡ã¯Servicesãƒ¬ã‚¤ãƒ¤ãƒ¼ã§å®Ÿè£…
- UIã¨ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ã‚’åˆ†é›¢
- ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã‚’é©åˆ‡ã«è¡Œã†

---

## ãƒ©ã‚¤ã‚»ãƒ³ã‚¹

ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ä¸€éƒ¨ã¨ã—ã¦ã€åŒã˜ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ãŒé©ç”¨ã•ã‚Œã¾ã™ã€‚
